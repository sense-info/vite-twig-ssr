{
  "main_domain": "f3cms.com",
  "current": {
    "title": "vite-twig-ssr README",
    "subtitle": "把 README 內容直接渲染在範例頁面",
    "tagline": "Vite dev-server plugin that renders Twig templates with Twig.js, auto-maps JSON mock data, and keeps PHP-compatible views in sync with HMR."
  },
  "overview": [
    "PHP 後端相容：開發用 Vite + Twig.js，佈署仍交給 PHP/Twig，模板不需分叉。",
    "自動 Mock 綁定：請求 src/views/foo.twig 時，會找 mock/foo.json 並注入為 context。",
    "雙重 HMR：改 .twig 或對應 .json 立即重新渲染並全頁更新，迴圈 < 50ms。",
    "錯誤可視化：Twig/JSON 失敗時推送 Vite Error Overlay，頁面同時輸出 500 示意。"
  ],
  "requirements": [
    "Node.js >= 20",
    "NPM/Yarn/Pnpm 皆可，本範例以 npm 為例"
  ],
  "install": "npm install --save-dev vite-twig-ssr",
  "minimal_config": "// vite.config.js / .ts\nimport { defineConfig } from 'vite';\nimport viteTwig from 'vite-twig-ssr';\n\nexport default defineConfig({\n    plugins: [\n        viteTwig({\n            viewsPath: './src/views',   // Twig 根目錄\n            mockPath: './mock',         // JSON 假資料目錄\n            globalData: {\n                main_domain: 'f3cms.com',\n                opts: {\n                    default: {\n                        contact_mail: 'design-system@example.com',\n                    },\n                },\n            },\n            filters: {\n                headline: (value) => String(value || '').toUpperCase(),\n            },\n            functions: {\n                asset: (value) => `/assets/${value}`,\n            },\n        }),\n    ],\n    server: {\n        open: '/views/index.twig', // 直接開啟 Twig 入口頁\n    },\n});",
  "mock_mapping": [
    {
      "twig": "src/views/about.twig",
      "mock": "mock/about.json",
      "behavior": "自動讀取 JSON 作為 context"
    },
    {
      "twig": "src/views/landings/home.twig",
      "mock": "mock/landings/home.json",
      "behavior": "巢狀路徑同名映射"
    }
  ],
  "mock_notes": [
    "allowMissingMock: true（預設）時，缺少對應 JSON 會注入空物件並合併 globalData。",
    "設為 false 時，缺少 JSON 會直接拋錯，確保資料契約被滿足。"
  ],
  "filters_intro": "vite-twig-ssr 會將 filters、functions 註冊到 Twig.js，接受物件或陣列形式：",
  "filters_snippet": "filters: {\n    currency: (value) => new Intl.NumberFormat('en-US', {\n        style: 'currency', currency: 'USD'\n    }).format(value)\n}",
  "functions_snippet": "functions: [\n    {\n        name: 'asset',\n        func: (value) => `/static/${value}`,\n    }\n]",
  "dx": [
    "HMR for Twig + JSON：監控 viewsPath 與 mockPath，任一檔案異動都觸發 full reload。",
    "錯誤疊加層：Twig 渲染或 JSON 解析失敗時推送 overlay，並在頁面輸出 500 頁示意。",
    "_file / _target metadata：自動注入檔案資訊，方便在 UI 中標示來源。",
    "feVersion 注入：預設為 process.env.FE_VERSION || package.json version || 'dev'。"
  ],
  "options": [
    { "name": "viewsPath", "type": "string ('src')", "description": "Twig 模板根目錄，支援絕對路徑" },
    { "name": "mockPath", "type": "string ('mock')", "description": "JSON 假資料根目錄" },
    { "name": "globalData", "type": "object", "description": "任何頁面都會被注入的共用資料" },
    { "name": "filters", "type": "object | array", "description": "Twig filters 定義" },
    { "name": "functions", "type": "object | array", "description": "Twig functions 定義" },
    { "name": "namespaces", "type": "Record<string,string>", "description": "Twig namespace 對應根路徑" },
    { "name": "allowMissingMock", "type": "boolean (true)", "description": "缺少同名 JSON 時是否容忍" },
    { "name": "base", "type": "string", "description": "Twig.js base 選項，用於覆寫 extends/include 搜尋路徑" },
    { "name": "debug / trace", "type": "boolean", "description": "透傳至 Twig.js" },
    { "name": "extend", "type": "function (Twig)", "description": "直接擴充 Twig.js（自訂 tag 等）" }
  ],
  "example_points": [
    "展示 JSON Mock (example/mock/index.json)",
    "Twig extends/include + components（含 components/navbar.twig）",
    "<script type=\"module\" src=\"/src/main.js\"> 可正常運作"
  ],
  "example_run": "npm run example:dev\n# 開啟 http://localhost:5173/views/index.twig",
  "scripts": "npm run lint   # ESLint (Node + browser overrides)\nnpm test       # Mocha 渲染器單元測試",
  "test_focus": "測試重點：模板/JSON/global data 合併、自訂 filter/function 註冊、JSON 解析與缺漏錯誤訊息。",
  "license": "MIT"
}
